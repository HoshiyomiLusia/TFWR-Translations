# 迷宫
`Items.Weird_Substance` 是通过 [施肥](docs/unlocks/fertilizer.md) 植物获得的，它对灌木丛有奇怪的效果。如果无人机在灌木丛上方并调用 `use_item(Items.Weird_Substance, amount)`，灌木丛就会变成一个树篱迷宫。 迷宫的大小取决于所用的 `Items.Weird_Substance` 数量（`use_item()` 调用的第二个参数）。 未进行迷宫升级时，使用 `n` 个 `Items.Weird_Substance` 将生成一个 `n`x`n` 的迷宫。每个迷宫升级等级会翻倍宝藏，但也会翻倍所需的 `Items.Weird_Substance` 数量。 因此，要制作一个完整的田地迷宫：

`plant(Entities.Bush)
n_substance = get_world_size() * 2**(num_unlocked(Unlocks.Mazes) - 1)
use_item(Items.Weird_Substance, n_substance)`

由于某种原因，无人机无法飞过树篱，尽管它们看起来不那么高。

在树篱中有一个隐藏的宝藏。使用 `harvest()` 在宝藏上可获得与迷宫面积相等的金子。（例如，一个 5x5 的迷宫会产出 25 金。）

如果你在其他地方使用 `harvest()`，迷宫就会消失。

当无人机在宝藏之上时，`get_entity_type()` 的值为 `Entities.Treasure`，在迷宫的其他地方则为 `Entities.Hedge`。

除非你重用迷宫（见下文重用迷宫的方法），迷宫中不会包含任何循环。因此，无人机不可能在不返回的情况下回到同一位置。

你可以通过尝试穿墙来检查是否有墙。 `move()` 返回 `True` 表示成功，返回 `False` 表示失败。

如果你不知道如何到达宝藏，请查看提示 1。它会告诉你如何解决这个问题。

额外挑战：您还可以通过在宝藏上再次使用相同数量的 `Items.Weird_Substance` 来重用迷宫。 这将增加宝藏中的金子数量一个完整的迷宫，并将其移动到迷宫中的随机位置。

在宝藏上使用 `measure()` 会以元组形式返回其将要移动的位置。 `next_x, next_y = measure()`

每次宝藏移动时，可能会从迷宫中移除一个随机墙。因此，重用的迷宫可能包含循环。

注意，迷宫中的循环会使事情变得更加困难，因为这意味着可以再次到达同一位置而不需要返回。
重用迷宫并不会比直接收获和生成新迷宫获得更多的金子。
这完全是一个额外的挑战，你可以选择跳过。
只有当额外的信息和捷径帮助你更快地解决迷宫时，这才值得。

同一个迷宫最多可以解决 300 次。这相当于 299 次重新定位。之后，在宝藏上使用奇怪的物质不会再增加它的金子，`measure()` 将返回 `None`。

<spoiler=显示提示 1>这是解决问题的一般方法：

创建一个迷宫，想象你就是无人机。

想想如果你在迷宫中，你会如何找到宝藏。

一步步写下你的策略，以便其他人可以不经过思考就能跟随。

现在尝试将你的步骤转化为代码。
</spoiler>
<spoiler=显示提示 2>只要没有循环：所有墙实际上只是一个大墙。如果你沿着墙走，它会引导你穿过整个迷宫。
这种方法需要非常少的代码，你不需要跟踪你已经去过哪里。大约 10 行代码就足够了。</spoiler>
<spoiler=显示提示 3>与将无人机向东或向西等绝对方向移动相比，将无人机按“右转”或“左转”等相对方向移动非常有用。为此，你需要跟踪无人机当前移动的方向。无人机从未实际旋转，但你仍然可以在代码中保留“虚拟”旋转。
以下索引技巧对这有帮助：

`directions = [North, East, South, West]
index = 0`

使用 `% 4` 允许其在“圈中旋转”，这样在 `West` 之后会回到 `North`。
`# 右转
index = (index + 1) % 4`

`# 左转
index = (index - 1) % 4

move(directions[index])`</spoiler>
<spoiler=显示提示 4>如果你无法解决它，你总可以让自己轻松一些，效率低一些。
解决一个 `1`x`1`的迷宫是很简单的。</spoiler>